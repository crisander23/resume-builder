<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CLASSIC RESUME BUILDER + AI</title>
<style>
  /* ================= Theme Tokens ================= */
  :root{
    --bg:#000;                   /* dark default */
    --ink:#e6eaf2;
    --muted:#a9b0bf;
    --glass:rgba(255,255,255,.08);
    --border:rgba(255,255,255,.16);
    --btn-surface:rgba(255,255,255,.06);

    /* unified minimalist blue for BOTH themes */
    --btn-primary:#2563eb;
    --btn-primary-ink:#ffffff;

    --radius:16px;
  }
  /* Light mode overrides */
  :root[data-theme="light"]{
    --bg:#f5f7fb;
    --ink:#0f172a;
    --muted:#475569;
    --glass:#ffffff;
    --border:#e2e8f0;
    --btn-surface:#f1f5f9;
  }

  *{ box-sizing:border-box }
  html,body{ height:100%; margin:0 }
  body{
    min-height:100%;
    background:var(--bg); color:var(--ink);
    font:14px/1.45 Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    letter-spacing:.01em;
  }

  /* ================= 50/50 Layout ================= */
  .wrap{
    width:100vw; height:100dvh;
    display:grid; grid-template-columns:50% 50%;
  }
  .wrap > *{ min-width:0; min-height:0; }

  @media (max-width: 900px){
    .wrap{ grid-template-columns:1fr; height:auto; }
  }

  /* ================= Form Pane ================= */
  .panel{
    padding:16px; overflow:auto;
    background:var(--glass); border-right:1px solid var(--border);
    backdrop-filter: blur(12px) saturate(120%);
    -webkit-backdrop-filter: blur(12px) saturate(120%);
  }
  .panel-header{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:6px 0 12px; border-bottom:1px solid var(--border);
  }
  .title{ font-weight:900; letter-spacing:.02em; font-size:16px; text-transform:uppercase; }
  .controls{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  .btn{
    border:1px solid var(--border);
    background:var(--btn-surface);
    color:var(--ink);
    padding:8px 12px; border-radius:12px; cursor:pointer;
  }
  .btn.primary{ background:var(--btn-primary); color:var(--btn-primary-ink); border-color:var(--btn-primary); font-weight:700; }

  /* Icon-only toggle */
  .icon-btn{
    width:38px; height:38px; border-radius:999px;
    display:inline-flex; align-items:center; justify-content:center;
    border:1px solid var(--border); background:var(--btn-surface); cursor:pointer;
  }
  .icon{ width:18px; height:18px; display:block; }
  /* show sun in light, moon in dark */
  :root[data-theme="light"] .icon--sun{ display:block }
  :root[data-theme="light"] .icon--moon{ display:none }
  :root:not([data-theme="light"]) .icon--sun{ display:none }
  :root:not([data-theme="light"]) .icon--moon{ display:block }

  .tabs{ display:flex; gap:8px; padding:10px 0; overflow:auto; }
  .tab{
    white-space:nowrap; padding:8px 12px; border-radius:999px; cursor:pointer;
    border:1px solid var(--border); background:var(--btn-surface); color:var(--ink); font-weight:600; font-size:12px;
  }
  .tab.active{ outline:2px solid var(--border); background:var(--btn-primary); color:#fff; }
  .tab.magic{ border-color: #8b5cf6; color: #a78bfa; } 
  .tab.magic.active { background: #7c3aed; color: #fff; }

  .slides{ position:relative; overflow:hidden; border-radius:12px; border:1px solid var(--border); }
  .rail{ display:flex; transition:transform .3s ease; will-change:transform; }
  .section{ flex:0 0 100%; padding:14px; min-height:320px; }
  .section h3{ margin:0 0 6px; font-size:14px; }
  .muted{ color:var(--muted); font-size:12px; margin-bottom:8px; }

  .row{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
  @media (max-width:560px){ .row{ grid-template-columns:1fr; } }

  label{ display:block; font-size:12px; color:var(--muted); margin:10px 0 6px; }
  input, textarea{
    width:100%; color:var(--ink);
    background: var(--btn-surface);
    border:1px solid var(--border); outline:none; border-radius:12px;
    padding:10px 12px;
  }
  textarea{ min-height:90px; resize:vertical; }
  .section-card{ border:1px dashed var(--border); border-radius:12px; padding:10px; margin:10px 0; background: var(--btn-surface); }

  .nav{ display:flex; justify-content:space-between; gap:8px; padding:10px 0 0; margin-top:10px; border-top:1px solid var(--border); }

  /* ================= Preview Pane ================= */
  .preview{
    background:var(--bg); display:flex; align-items:flex-start; justify-content:center;
    overflow:auto; padding:16px;
  }
  .page{
    width:min(100%,816px);
    background:#fff; color:#111; border-radius:12px;
    padding:.75in .8in;
    font-family:"Times New Roman", Times, Georgia, serif; font-size:11pt; line-height:1.25;
    box-shadow: 0 12px 26px rgba(0,0,0,.2);
  }
  .name{ text-align:center; font-weight:700; font-size:18pt; letter-spacing:.2px; }
  .contact{ text-align:center; font-size:10.5pt; color:#444; margin-top:4px; }
  .rule{ border:0; border-top:1px solid #000; margin:8px 0 6px; }
  .section-pv{ margin-top:8px; }
  .section-title{
    font-variant:small-caps; font-weight:700; letter-spacing:.06em;
    border-bottom:1px solid #000; padding-bottom:2px; margin-bottom:6px; font-size:11.5pt;
  }
  .row-grid{ display:grid; grid-template-columns:1fr auto; gap:8px; align-items:baseline; margin-top:2px; }
  .org{ font-weight:700 } .role{ font-style:italic } .place{ white-space:nowrap }
  .bullets{ margin:2px 0 6px 0; padding-left:16px; } .bullets li{ margin:2px 0 }
  .tight{ margin:0; padding-left:16px; } .tight li{ margin:2px 0 }

  /* ================= Print ================= */
  @page{ size: Letter; margin:.6in; }
  @media print{
    body{ background:#fff }
    .wrap{ display:block }
    .panel{ display:none }
    .preview{ padding:0 }
    .page{ width:auto; padding:0; border-radius:0; box-shadow:none; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="panel-header">
        <div class="title">AI RESUME BUILDER</div>
        <div class="controls">
          <button id="modeBtn" class="icon-btn" aria-label="Toggle theme">
            <svg class="icon icon--moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2m0 16v2m10-10h-2M4 12H2m15.54 6.46-1.41-1.41M7.88 7.88 6.46 6.46m10.96 0-1.42 1.42M7.88 16.12 6.46 17.54"></path></svg>
            <svg class="icon icon--sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
          </button>
          <button class="btn" onclick="fillSample()">Sample</button>
          <button class="btn" onclick="clearAll()">Clear</button>
          <button class="btn primary" onclick="window.print()">Save PDF</button>
        </div>
      </div>

      <div class="tabs" id="tabs">
        <button class="tab magic active" data-i="0">✨ AI Writer</button>
        <button class="tab" data-i="1">Header</button>
        <button class="tab" data-i="2">Summary</button>
        <button class="tab" data-i="3">Skills</button>
        <button class="tab" data-i="4">Education</button>
        <button class="tab" data-i="5">Experience</button>
        <button class="tab" data-i="6">Projects</button>
        <button class="tab" data-i="7">Certs</button>
        <button class="tab" data-i="8">Awards</button>
        <button class="tab" data-i="9">Activities</button>
        <button class="tab" data-i="10">Languages</button>
        <button class="tab" data-i="11">Interests</button>
        <button class="tab" data-i="12">Custom</button>
      </div>

      <div class="slides">
        <div id="rail" class="rail">
          
          <section class="section">
             <h3>AI Resume Generator</h3>
             <div class="muted">Paste the Job Description below. The AI will create a targeted resume for you.</div>
             <label>Job Description</label>
             <textarea id="jobDesc" style="height:200px" placeholder="Paste the job post here..."></textarea>
             <button class="btn primary" id="aiBtn" onclick="generateAI()">⚡ Generate Resume</button>
             <p class="muted" style="margin-top:10px">Note: This will clear current fields and fill them with AI suggestions.</p>
          </section>

          <section class="section">
            <h3>Header / Contact</h3>
            <label>Name</label><input id="name" placeholder="Your Full Name" />
            <div class="row">
              <div><label>Location</label><input id="loc" placeholder="City, Country" /></div>
              <div><label>Phone</label><input id="phone" placeholder="+63 ___ ___ ____" /></div>
            </div>
            <div class="row">
              <div><label>Email</label><input id="email" placeholder="you@email.com" /></div>
              <div><label>Website / Portfolio</label><input id="portfolio" placeholder="your-site.com" /></div>
            </div>
            <div class="row">
              <div><label>LinkedIn</label><input id="linkedin" placeholder="linkedin.com/in/username" /></div>
              <div><label>Other Link</label><input id="otherlink" placeholder="e.g., Behance, ResearchGate" /></div>
            </div>
          </section>

          <section class="section">
            <h3>Summary</h3>
            <label>Summary</label>
            <textarea id="summary" placeholder="Short professional overview."></textarea>
          </section>

          <section class="section">
            <h3>Skills</h3>
            <div id="skillsList"></div>
            <div><button class="btn" onclick="addSkillCategory()">+ Add Skill Category</button></div>
          </section>

          <section class="section">
            <h3>Education</h3>
            <div id="eduList"></div>
            <div><button class="btn" onclick="addEdu()">+ Add Education</button></div>
          </section>

          <section class="section">
            <h3>Experience</h3>
            <div id="expList"></div>
            <div><button class="btn" onclick="addExp()">+ Add Experience</button></div>
          </section>

          <section class="section">
            <h3>Projects / Portfolio</h3>
            <div id="projList"></div>
            <div><button class="btn" onclick="addProj()">+ Add Project</button></div>
          </section>

          <section class="section">
            <h3>Certifications</h3>
            <div id="certList"></div>
            <button class="btn" onclick="addCert()">+ Add Certification</button>
          </section>

          <section class="section">
            <h3>Awards</h3>
            <div id="awardList"></div>
            <button class="btn" onclick="addAward()">+ Add Award</button>
          </section>

          <section class="section">
            <h3>Activities & Leadership</h3>
            <div id="actList"></div>
            <button class="btn" onclick="addActivity()">+ Add Activity</button>
          </section>

          <section class="section">
            <h3>Languages</h3>
            <div id="langList"></div>
            <button class="btn" onclick="addLanguage()">+ Add Language</button>
          </section>

          <section class="section">
            <h3>Interests</h3>
            <textarea id="interests" placeholder="Hobbies, interests, or volunteer focus."></textarea>
          </section>

          <section class="section">
            <h3>Custom Sections</h3>
            <div id="customList"></div>
            <div style="margin-top:8px;">
              <button class="btn" onclick="addCustomSection()">+ Add Custom Section</button>
            </div>
          </section>
        </div>
      </div>

      <div class="nav">
        <button id="prevBtn" class="btn">◀ Prev</button>
        <button id="nextBtn" class="btn primary">Next ▶</button>
      </div>
    </div>

    <div class="preview">
      <div class="page" id="page">
        <header>
          <div class="name" id="pvName">YOUR NAME</div>
          <div class="contact" id="pvContact">Location • Phone • email@example.com • website • LinkedIn</div>
        </header>
        <hr class="rule" />

        <section class="section-pv" id="pvSummaryWrap" style="display:none;">
          <div class="section-title">Summary</div>
          <div id="pvSummary"></div>
        </section>

        <section class="section-pv" id="pvEducation" style="display:none;">
          <div class="section-title">Education</div>
          <div id="pvEduList"></div>
        </section>

        <section class="section-pv" id="pvExperience" style="display:none;">
          <div class="section-title">Experience</div>
          <div id="pvExpList"></div>
        </section>

        <section class="section-pv" id="pvProjects" style="display:none;">
          <div class="section-title">Projects</div>
          <div id="pvProjList"></div>
        </section>

        <section class="section-pv" id="pvSkills" style="display:none;">
          <div class="section-title">Skills</div>
          <div id="pvSkillsList"></div>
        </section>

        <section class="section-pv" id="pvCerts" style="display:none;">
          <div class="section-title">Certifications</div>
          <ul class="tight" id="pvCertList"></ul>
        </section>

        <section class="section-pv" id="pvAwards" style="display:none;">
          <div class="section-title">Awards</div>
          <ul class="tight" id="pvAwardList"></ul>
        </section>

        <section class="section-pv" id="pvActs" style="display:none;">
          <div class="section-title">Activities & Leadership</div>
          <ul class="tight" id="pvActList"></ul>
        </section>

        <section class="section-pv" id="pvLangs" style="display:none;">
          <div class="section-title">Languages</div>
          <ul class="tight" id="pvLangList"></ul>
        </section>

        <section class="section-pv" id="pvInterests" style="display:none;">
          <div class="section-title">Interests</div>
          <div id="pvInterestsText"></div>
        </section>

        <div id="pvCustomSections"></div>
      </div>
    </div>
  </div>

<script>
/* ========= GEMINI AI INTEGRATION ========= */
// ⚠️ PASTE YOUR NEW API KEY BELOW
const GEMINI_API_KEY = "AIzaSyCvx5hRPrAK7E2w3F9u0v08awGefn_48Y4";

async function generateAI() {
  const jobDesc = document.getElementById('jobDesc').value.trim();
  const btn = document.getElementById('aiBtn');
  
  if (!jobDesc) {
    alert("Please paste a job description first.");
    return;
  }
  if (GEMINI_API_KEY.includes("PASTE_YOUR")) {
    alert("Please update the code with your valid Gemini API Key.");
    return;
  }

  btn.textContent = "Generating...";
  btn.disabled = true;

  const prompt = `
    You are an expert Resume Writer. 
    Based on the JOB DESCRIPTION below, create a complete, professional resume in valid JSON format.
    Invent a realistic persona (Name, Edu, Exp) that perfectly fits the job.
    
    STRICT JSON OUTPUT ONLY. No Markdown. No code blocks.
    Structure matches these specific fields:
    {
      "name": "Full Name",
      "location": "City, Country",
      "phone": "+1 555...",
      "email": "email@example.com",
      "linkedin": "linkedin.com/in/...",
      "summary": "Professional summary optimized for the job.",
      "skills": [
        { "category": "Core Skills", "items": "Java, Python, SQL" },
        { "category": "Tools", "items": "Git, Docker, JIRA" }
      ],
      "education": [
        { "school": "University Name", "degree": "Degree Name", "location": "City, State", "start": "2018", "end": "2022", "notes": "Relevant coursework..." }
      ],
      "experience": [
        { "org": "Company A", "role": "Job Title", "location": "City", "start": "2023", "end": "Present", "bullets": ["Action verb result 1", "Action verb result 2"] },
        { "org": "Company B", "role": "Previous Title", "location": "City", "start": "2020", "end": "2023", "bullets": ["Action verb result 1", "Action verb result 2"] }
      ],
      "projects": [
         { "name": "Project Name", "context": "Personal/Freelance", "bullets": ["Description of what was built"] }
      ],
      "certifications": ["Cert Name (Year)"],
      "languages": ["Language 1", "Language 2"]
    }

    JOB DESCRIPTION:
    ${jobDesc}
  `;

  try {
    const response = await fetch(
      `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}`,
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
      }
    );

    if (!response.ok) throw new Error("API Failed");

    const data = await response.json();
    let text = data.candidates[0].content.parts[0].text;
    text = text.replace(/```json|```/g, "").trim(); // Clean markdown
    const json = JSON.parse(text);

    // CLEAR CURRENT
    clearAll();

    // POPULATE FIELDS
    document.getElementById('name').value = json.name || "";
    document.getElementById('loc').value = json.location || "";
    document.getElementById('phone').value = json.phone || "";
    document.getElementById('email').value = json.email || "";
    document.getElementById('linkedin').value = json.linkedin || "";
    document.getElementById('summary').value = json.summary || "";

    // Populate Lists using existing helper functions
    (json.skills || []).forEach(s => addSkillCategory({ label: s.category, items: s.items }));
    (json.education || []).forEach(e => addEdu({ school: e.school, degree: e.degree, place: e.location, start: e.start, end: e.end, notes: e.notes }));
    (json.experience || []).forEach(e => addExp({ org: e.org, role: e.role, place: e.location, start: e.start, end: e.end, bullets: e.bullets }));
    (json.projects || []).forEach(p => addProj({ name: p.name, context: p.context, bullets: p.bullets }));
    (json.certifications || []).forEach(c => addCert({ text: c }));
    (json.languages || []).forEach(l => addLanguage({ text: l }));

    // Trigger updates
    updateHeader();
    updateSummary();
    
    // Switch to Header Tab to show result
    go(1);
    alert("Resume Generated! Please review the tabs.");

  } finally {
    btn.textContent = "⚡ Generate Resume";
    btn.disabled = false;
  }
}

/* ================= THEME & UI LOGIC (Original) ================= */
(function initTheme(){
  const saved = localStorage.getItem('resume_theme');
  if(saved){ document.documentElement.setAttribute('data-theme', saved); }
  document.getElementById('modeBtn').addEventListener('click', ()=>{
    const isLight = document.documentElement.getAttribute('data-theme') === 'light';
    const next = isLight ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('resume_theme', next);
  });
})();

const rail = document.getElementById('rail');
const tabs = Array.from(document.querySelectorAll('.tab'));
let step = 0;
function go(i){
  step = Math.max(0, Math.min(tabs.length-1, i));
  rail.style.transform = `translateX(-${step*100}%)`;
  tabs.forEach((t,idx)=> t.classList.toggle('active', idx===step));
}
tabs.forEach(t => t.addEventListener('click', ()=> go(parseInt(t.dataset.i,10))));
document.getElementById('prevBtn').addEventListener('click', ()=> go(step-1));
document.getElementById('nextBtn').addEventListener('click', ()=> go(step+1));
addEventListener('keydown', (e)=>{ 
  // Disable arrow keys if typing in textarea
  if(e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') return;
  if(e.key==='ArrowRight') go(step+1); 
  if(e.key==='ArrowLeft') go(step-1); 
});
go(0); // Start at AI Tab

const $ = (id)=>document.getElementById(id);
const esc = (s)=> (s||"").toString();

/* ----- Header ----- */
function updateHeader(){
  const name = esc($('name').value);
  const loc = esc($('loc').value);
  const phone = esc($('phone').value);
  const email = esc($('email').value);
  const portfolio = esc($('portfolio').value);
  const linkedin = esc($('linkedin').value);
  const other = esc($('otherlink').value);
  const parts=[];
  if(loc) parts.push(loc);
  if(phone) parts.push(phone);
  if(email) parts.push(email);
  if(portfolio) parts.push(portfolio);
  if(linkedin) parts.push(linkedin);
  if(other) parts.push(other);
  $('pvName').textContent = name || 'YOUR NAME';
  $('pvContact').textContent = parts.join(' • ');
}
['name','loc','phone','email','portfolio','linkedin','otherlink'].forEach(id=> $(id).addEventListener('input', updateHeader));

/* ----- Summary ----- */
function updateSummary(){
  const s = esc($('summary').value).trim();
  $('pvSummaryWrap').style.display = s ? '' : 'none';
  $('pvSummary').textContent = s;
}
$('summary').addEventListener('input', updateSummary);

/* ----- Skills (categories) ----- */
function addSkillCategory(pref={}){
  const wrap = document.createElement('div');
  wrap.className = 'section-card';
  wrap.innerHTML = `
    <label>Category Label</label>
    <input class="sk-label" value="${pref.label||''}" placeholder="Category name">
    <label>Items</label>
    <input class="sk-items" value="${pref.items||''}" placeholder="e.g., Item 1, Item 2">
    <div style="margin-top:8px;">
      <button class="btn" onclick="this.closest('.section-card').remove(); renderSkills();">Remove</button>
    </div>`;
  $('skillsList').appendChild(wrap);
  wrap.querySelectorAll('input').forEach(el=>el.addEventListener('input', renderSkills));
  renderSkills();
}
function renderSkills(){
  const pv=$('pvSkillsList'); pv.innerHTML='';
  const cards=Array.from($('skillsList').children);
  const wrap=document.getElementById('pvSkills');
  if(cards.length===0){ wrap.style.display='none'; return; }
  wrap.style.display='';
  cards.forEach(c=>{
    const label = (c.querySelector('.sk-label').value || 'Skills');
    const items = c.querySelector('.sk-items').value || '';
    const div = document.createElement('div'); div.innerHTML = `<strong>${label}:</strong> ${items}`;
    pv.appendChild(div);
  });
}

/* ----- Education ----- */
function addEdu(pref={}){
  const card=document.createElement('div'); card.className='section-card';
  card.innerHTML=`
    <div class="row">
      <div><label>School</label><input class="ed-school" value="${pref.school||''}" placeholder="University"></div>
      <div><label>Degree</label><input class="ed-degree" value="${pref.degree||''}" placeholder="Degree"></div>
    </div>
    <div class="row">
      <div><label>Location</label><input class="ed-place" value="${pref.place||''}" placeholder="City, Country"></div>
      <div class="row">
        <div><label>Start</label><input class="ed-start" value="${pref.start||''}" placeholder="Year"></div>
        <div><label>End</label><input class="ed-end" value="${pref.end||''}" placeholder="Year"></div>
      </div>
    </div>
    <label>Notes</label>
    <textarea class="ed-notes" placeholder="GPA, honors">${pref.notes||''}</textarea>
    <div style="margin-top:8px;"><button class="btn" onclick="this.closest('.section-card').remove(); renderEdu();">Remove</button></div>`;
  $('eduList').appendChild(card);
  card.querySelectorAll('input,textarea').forEach(el=>el.addEventListener('input', renderEdu));
  renderEdu();
}
function renderEdu(){
  const pv=$('pvEduList'); pv.innerHTML='';
  const cards=Array.from($('eduList').children);
  const wrap=document.getElementById('pvEducation');
  if(cards.length===0){ wrap.style.display='none'; return; }
  wrap.style.display='';
  cards.forEach(c=>{
    const school=c.querySelector('.ed-school').value;
    const degree=c.querySelector('.ed-degree').value;
    const place=c.querySelector('.ed-place').value;
    const start=c.querySelector('.ed-start').value;
    const end=c.querySelector('.ed-end').value;
    const notes=c.querySelector('.ed-notes').value;
    const row=document.createElement('div'); row.className='row-grid';
    row.innerHTML=`<div><div class="org">${school}</div><div class="role">${degree}</div></div>
                   <div class="place">${place?place+' | ':''}${(start||end)?(start+'–'+end):''}</div>`;
    pv.appendChild(row);
    if(notes){ const p=document.createElement('div'); p.textContent=notes; pv.appendChild(p); }
  });
}

/* ----- Experience ----- */
function addExp(pref={}){
  const card=document.createElement('div'); card.className='section-card';
  card.innerHTML=`
    <div class="row">
      <div><label>Organization</label><input class="ex-org" value="${pref.org||''}" placeholder="Company"></div>
      <div><label>Role</label><input class="ex-role" value="${pref.role||''}" placeholder="Title"></div>
    </div>
    <div class="row">
      <div><label>Location</label><input class="ex-place" value="${pref.place||''}" placeholder="City"></div>
      <div class="row">
        <div><label>Start</label><input class="ex-start" value="${pref.start||''}" placeholder="Year"></div>
        <div><label>End</label><input class="ex-end" value="${pref.end||''}" placeholder="Present"></div>
      </div>
    </div>
    <label>Bullets</label>
    <textarea class="ex-bullets" placeholder="- Achieved X...">${(pref.bullets||[]).join('\n')}</textarea>
    <div style="margin-top:8px;"><button class="btn" onclick="this.closest('.section-card').remove(); renderExp();">Remove</button></div>`;
  $('expList').appendChild(card);
  card.querySelectorAll('input,textarea').forEach(el=>el.addEventListener('input', renderExp));
  renderExp();
}
function renderExp(){
  const pv=$('pvExpList'); pv.innerHTML='';
  const cards=Array.from($('expList').children);
  const wrap=document.getElementById('pvExperience');
  if(cards.length===0){ wrap.style.display='none'; return; }
  wrap.style.display='';
  cards.forEach(c=>{
    const org=c.querySelector('.ex-org').value;
    const role=c.querySelector('.ex-role').value;
    const place=c.querySelector('.ex-place').value;
    const start=c.querySelector('.ex-start').value;
    const end=c.querySelector('.ex-end').value;
    const bullets=c.querySelector('.ex-bullets').value.split('\n').map(s=>s.trim()).filter(Boolean);
    const block=document.createElement('div');
    const row=document.createElement('div'); row.className='row-grid';
    row.innerHTML=`<div><div class="org">${org}</div><div class="role">${role}</div></div>
                   <div class="place">${place?place+' | ':''}${(start||end)?(start+'–'+end):''}</div>`;
    block.appendChild(row);
    if(bullets.length){
      const ul=document.createElement('ul'); ul.className='bullets';
      bullets.forEach(b=>{ const li=document.createElement('li'); li.textContent=b.replace(/^-+\s*/,''); ul.appendChild(li); });
      block.appendChild(ul);
    }
    pv.appendChild(block);
  });
}

/* ----- Projects ----- */
function addProj(pref={}){
  const card=document.createElement('div'); card.className='section-card';
  card.innerHTML=`
    <div class="row">
      <div><label>Project Name</label><input class="pr-name" value="${pref.name||''}" placeholder="Title"></div>
      <div><label>Context</label><input class="pr-context" value="${pref.context||''}" placeholder="e.g., Personal"></div>
    </div>
    <label>Bullets</label>
    <textarea class="pr-bullets" placeholder="- Description">${(pref.bullets||[]).join('\n')}</textarea>
    <div style="margin-top:8px;"><button class="btn" onclick="this.closest('.section-card').remove(); renderProj();">Remove</button></div>`;
  $('projList').appendChild(card);
  card.querySelectorAll('input,textarea').forEach(el=>el.addEventListener('input', renderProj));
  renderProj();
}
function renderProj(){
  const pv=$('pvProjList'); pv.innerHTML='';
  const cards=Array.from($('projList').children);
  const wrap=document.getElementById('pvProjects');
  if(cards.length===0){ wrap.style.display='none'; return; }
  wrap.style.display='';
  cards.forEach(c=>{
    const name=c.querySelector('.pr-name').value;
    const ctx=c.querySelector('.pr-context').value;
    const bullets=c.querySelector('.pr-bullets').value.split('\n').map(s=>s.trim()).filter(Boolean);
    const block=document.createElement('div');
    const row=document.createElement('div'); row.className='row-grid';
    row.innerHTML=`<div><div class="org">${name}</div><div class="role">${ctx}</div></div><div class="place"></div>`;
    block.appendChild(row);
    if(bullets.length){
      const ul=document.createElement('ul'); ul.className='bullets';
      bullets.forEach(b=>{ const li=document.createElement('li'); li.textContent=b.replace(/^-+\s*/,''); ul.appendChild(li); });
      block.appendChild(ul);
    }
    pv.appendChild(block);
  });
}

/* ----- Simple lists ----- */
function addCert(pref={}){ addSimple('certList','pvCerts','pvCertList',pref.text||''); }
function addAward(pref={}){ addSimple('awardList','pvAwards','pvAwardList',pref.text||''); }
function addActivity(pref={}){ addSimple('actList','pvActs','pvActList',pref.text||''); }
function addLanguage(pref={}){ addSimple('langList','pvLangs','pvLangList',pref.text||''); }
function addSimple(formId,wrapId,listId,val){
  const card=document.createElement('div'); card.className='section-card';
  card.innerHTML=`
    <label>Item</label>
    <input class="simple-item" value="${val}" placeholder="Description">
    <div style="margin-top:8px;"><button class="btn" onclick="this.closest('.section-card').remove(); renderSimple('${formId}','${wrapId}','${listId}');">Remove</button></div>`;
  $(formId).appendChild(card);
  card.querySelector('.simple-item').addEventListener('input',()=>renderSimple(formId,wrapId,listId));
  renderSimple(formId,wrapId,listId);
}
function renderSimple(formId,wrapId,listId){
  const items=Array.from($(formId).children);
  const wrap=$(wrapId), ul=$(listId);
  ul.innerHTML='';
  if(items.length===0){ wrap.style.display='none'; return; }
  wrap.style.display='';
  items.forEach(c=>{
    const t=(c.querySelector('.simple-item').value||'').trim();
    if(t){ const li=document.createElement('li'); li.textContent=t; ul.appendChild(li); }
  });
}

/* ----- Interests ----- */
$('interests').addEventListener('input', ()=>{
  const t=( $('interests').value || '' ).trim();
  $('pvInterests').style.display = t ? '' : 'none';
  $('pvInterestsText').textContent = t;
});

/* ----- Custom Sections ----- */
function addCustomSection(pref = {}) {
  const card = document.createElement('div');
  card.className = 'section-card';
  card.innerHTML = `
    <label>Title</label>
    <input class="cs-title" value="${pref.title || ''}" placeholder="Section Title">
    <label>Content</label>
    <textarea class="cs-lines" placeholder="- Bullets...">${(pref.lines || []).join('\n')}</textarea>
    <div style="margin-top:8px;">
      <button class="btn" onclick="this.closest('.section-card').remove(); renderCustomSections();">Remove</button>
    </div>`;
  document.getElementById('customList').appendChild(card);
  card.querySelectorAll('input,textarea').forEach(el => el.addEventListener('input', renderCustomSections));
  renderCustomSections();
}
function renderCustomSections() {
  const wrap = document.getElementById('pvCustomSections');
  wrap.innerHTML = '';
  const cards = Array.from(document.getElementById('customList').children);
  cards.forEach(c => {
    const title = (c.querySelector('.cs-title').value || '').trim();
    const lines = (c.querySelector('.cs-lines').value || '')
      .split('\n').map(s => s.replace(/^-+\s*/, '').trim()).filter(Boolean);
    if (!title && !lines.length) return;
    const sec = document.createElement('section'); sec.className = 'section-pv';
    if (title) {
      const h = document.createElement('div'); h.className = 'section-title'; h.textContent = title; sec.appendChild(h);
    }
    if (lines.length) {
      const ul = document.createElement('ul'); ul.className = 'bullets';
      lines.forEach(t => { const li = document.createElement('li'); li.textContent = t; ul.appendChild(li); });
      sec.appendChild(ul);
    }
    wrap.appendChild(sec);
  });
}

/* ================= CLEAR & SAMPLE ================= */
function fillSample(){
  clearAll();
  $('name').value = "LOREM IPSUM";
  $('loc').value = "City, Country";
  $('phone').value = "+1 555 0123";
  $('email').value = "lorem@example.com";
  
  $('summary').value = "Experienced professional with a demonstrated history of working in the industry.";
  
  addSkillCategory({label:"Core", items:"Leadership, Strategy"});
  addEdu({ school:"University of Example", degree:"B.S. Science", start:"2015", end:"2019" });
  addExp({ org:"Example Corp", role:"Manager", start:"2020", end:"Present", bullets:["Led a team of 5", "Increased revenue by 20%"] });
  
  updateHeader(); updateSummary(); go(1);
}

function clearAll(){
  document.querySelectorAll('input,textarea').forEach(el=> el.value="");
  ['skillsList','eduList','expList','projList','certList','awardList','actList','langList','customList'].forEach(id=> $(id).innerHTML="");
  ['pvSkills','pvEducation','pvExperience','pvProjects','pvCerts','pvAwards','pvActs','pvLangs','pvInterests','pvSummaryWrap'].forEach(id=> $(id).style.display="none");
  $('pvName').textContent="YOUR NAME";
  $('pvContact').textContent="Location • Phone • email@example.com • website • LinkedIn";
  ['pvEduList','pvExpList','pvProjList','pvSkillsList','pvCertList','pvAwardList','pvActList','pvLangs','pvInterestsText','pvCustomSections'].forEach(id=> $(id).innerHTML="");
}

/* Init */
updateHeader(); 
updateSummary();
</script>
</body>
</html>